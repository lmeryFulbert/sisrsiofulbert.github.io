
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../04-hsrp/">
      
      
        <link rel="next" href="../06-reverse-proxy/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.1">
    
    
      
        <title>05 Docker - SISR BTS SIO FULBERT</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.45e1311d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#05-docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SISR BTS SIO FULBERT" class="md-header__button md-logo" aria-label="SISR BTS SIO FULBERT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SISR BTS SIO FULBERT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              05 Docker
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SISR BTS SIO FULBERT" class="md-nav__button md-logo" aria-label="SISR BTS SIO FULBERT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    SISR BTS SIO FULBERT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contexte
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Contexte
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contexte/01-pr%C3%A9sentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contexte SportLudique
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contexte/02_infrastructure-actuelle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure actuelle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contexte/03-Objectifs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objectifs à atteindre
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cours
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cours
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-virtualisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-Virtualisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02-DNS (Domain Name System)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-nat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03-NAT Dynamique (Masquerade) version Cisco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-hsrp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04-FailOver avec le Protocole HSRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    05 Docker
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    05 Docker
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtualisation-vs-containerisation" class="md-nav__link">
    <span class="md-ellipsis">
      Virtualisation vs Containerisation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-de-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Installation de Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exemple-de-deploiement-dapplication-nodejs-simple-via-un-container" class="md-nav__link">
    <span class="md-ellipsis">
      Exemple de deploiement d'Application Node.js Simple via un container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_1" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commande-utiles" class="md-nav__link">
    <span class="md-ellipsis">
      Commande utiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-avec-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Deploiement avec Docker Compose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappage-de-port-entre-hote-et-container" class="md-nav__link">
    <span class="md-ellipsis">
      Mappage de Port entre Hote et container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappage-des-volumes" class="md-nav__link">
    <span class="md-ellipsis">
      Mappage des volumes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lancement-des-containners" class="md-nav__link">
    <span class="md-ellipsis">
      Lancement des containners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commande-de-base-quand-on-travaille-avec-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Commande de base quand on travaille avec docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outil-dadministration" class="md-nav__link">
    <span class="md-ellipsis">
      Outil d'administration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusterisation-des-noeuds-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Clusterisation des noeuds Docker
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-reverse-proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 - Reverse Proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-openvpn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 - OpenVPN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-messagerie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 - Messagerie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-supervision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 - Supervision
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Infrastructure
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Infrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/01-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction sur l'infrastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/02-serveurs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Liste des serveurs et services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/03-infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/04-annexes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annexes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/05-fiche-recette/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fiche de Recette
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Situations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Situations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situations/01-deploiements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Situation 1 - Deploy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situations/02-documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Situation 2 - Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../situations/03-infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Situation 3 - Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtualisation-vs-containerisation" class="md-nav__link">
    <span class="md-ellipsis">
      Virtualisation vs Containerisation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-de-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Installation de Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exemple-de-deploiement-dapplication-nodejs-simple-via-un-container" class="md-nav__link">
    <span class="md-ellipsis">
      Exemple de deploiement d'Application Node.js Simple via un container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_1" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commande-utiles" class="md-nav__link">
    <span class="md-ellipsis">
      Commande utiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-avec-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Deploiement avec Docker Compose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappage-de-port-entre-hote-et-container" class="md-nav__link">
    <span class="md-ellipsis">
      Mappage de Port entre Hote et container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappage-des-volumes" class="md-nav__link">
    <span class="md-ellipsis">
      Mappage des volumes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lancement-des-containners" class="md-nav__link">
    <span class="md-ellipsis">
      Lancement des containners
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commande-de-base-quand-on-travaille-avec-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Commande de base quand on travaille avec docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outil-dadministration" class="md-nav__link">
    <span class="md-ellipsis">
      Outil d'administration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clusterisation-des-noeuds-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Clusterisation des noeuds Docker
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="05-docker">05 Docker</h1>
<h2 id="introduction">Introduction</h2>
<h3 id="virtualisation-vs-containerisation">Virtualisation vs Containerisation</h3>
<p>La <strong>virtualisation</strong> et la <strong>containerisation</strong> sont deux approches différentes pour la gestion des ressources et l'isolation des applications sur un système hôte.</p>
<ul>
<li>
<p><strong>Virtualisation</strong> : La virtualisation utilise des hyperviseurs pour créer des machines virtuelles (VMs), chaque VM exécutant un système d'exploitation complet. Cela nécessite plus de ressources car chaque VM contient son propre noyau d'OS.</p>
</li>
<li>
<p><strong>Containerisation</strong> : La containerisation utilise des conteneurs légers pour isoler les applications. Chaque conteneur partage le même noyau d'OS que l'hôte, ce qui les rend plus légers et plus rapides à démarrer.</p>
</li>
</ul>
<p><img alt="" src="../../medias/cours/docker/virtu_vs_container.png" /></p>
<h2 id="installation-de-docker">Installation de Docker</h2>
<p>Pour installer Docker, suivez les instructions de la documentation officielle selon votre système d'exploitation :</p>
<ul>
<li><a href="https://docs.docker.com/install/linux/">Installation de Docker sur Linux</a></li>
<li><a href="https://docs.docker.com/install/mac/">Installation de Docker sur macOS</a></li>
<li><a href="https://docs.docker.com/install/windows/">Installation de Docker sur Windows</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Compatibilité Hyper-V</p>
<p>Docker Desktop for Windows utilise Hyper-V, qui peut être incompatible avec d'autres hyperviseurs tels que VirtualBox. Si vous avez déjà VirtualBox installé, assurez-vous de vérifier la compatibilité avant d'installer Docker Desktop. Pour plus d'informations, consultez la <a href="https://docs.docker.com/desktop/install/windows-install/">documentation officielle de Docker</a>.</p>
</div>
<h2 id="dockerfile">Dockerfile</h2>
<p>Un <strong>Dockerfile</strong> est un script qui contient les instructions nécessaires pour créer une image Docker. Voici un exemple simple de Dockerfile pour une application web Node.js :</p>
<h3 id="exemple-de-deploiement-dapplication-nodejs-simple-via-un-container">Exemple de deploiement d'Application Node.js Simple via un container</h3>
<p>Créez un dossier pour votre application Node.js et créez un fichier <code>app.js</code> avec le contenu suivant :</p>
<div class="highlight"><pre><span></span><code><span class="c1">// app.js</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">statusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">200</span><span class="p">;</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;text/plain&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Hello, Docker!\n&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">3000</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Server running on http://localhost:</span><span class="si">${</span><span class="nx">port</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<h3 id="dockerfile_1">Dockerfile</h3>
<p>Créez un fichier appelé <code>Dockerfile</code> dans le même répertoire que votre application avec le contenu suivant :</p>
<div class="highlight"><pre><span></span><code><span class="c"># Use the official Node.js image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">node:14</span>

<span class="c"># Set the working directory</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/usr/src/app</span>

<span class="c"># Install app dependencies</span>
<span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install

<span class="c"># Bundle app source</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.

<span class="c"># Expose the port</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">3000</span>

<span class="c"># Command to run the application</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app.js&quot;</span><span class="p">]</span>
</code></pre></div>
<h2 id="docker-compose">Docker Compose</h2>
<p><strong>Docker Compose</strong> est un outil pour définir et gérer des applications Docker multi-conteneurs. Vous pouvez utiliser un fichier <code>docker-compose.yml</code> pour spécifier les services, les réseaux et les volumes nécessaires à votre application.</p>
<h3 id="commande-utiles">Commande utiles</h3>
<p>La commande <code>docker-compose up -d</code> est utilisée pour démarrer les services définis dans votre fichier <code>docker-compose.yml</code> en mode détaché (arrière-plan). Cela signifie que les conteneurs Docker seront lancés en arrière-plan, et vous pourrez continuer à utiliser votre terminal pour d'autres tâches sans bloquer sur les journaux des conteneurs.</p>
<p>Voici comment utiliser cette commande :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<p>Assurez-vous d'exécuter cette commande dans le répertoire où se trouve votre fichier <code>docker-compose.yml</code>. Docker Compose utilisera ce fichier pour créer et configurer les conteneurs.</p>
<p>Après avoir exécuté cette commande, Docker Compose lancera tous les services définis dans le fichier <code>docker-compose.yml</code>. Vous pouvez vérifier l'état des services avec la commande suivante :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>ps
</code></pre></div>
<p>Cette commande affiche l'état de tous les services définis dans le fichier <code>docker-compose.yml</code>. Si les services sont en cours d'exécution, vous devriez les voir répertoriés avec l'état "Up".</p>
<p>Pour arrêter les services et supprimer les conteneurs, vous pouvez utiliser la commande suivante :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>down
</code></pre></div>
<p>Si vous souhaitez voir les journaux des services en cours d'exécution, vous pouvez utiliser la commande <code>docker-compose logs</code>. Par exemple, pour afficher les journaux du service "app" :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>logs<span class="w"> </span>app
</code></pre></div>
<p>N'oubliez pas de remplacer "app" par le nom réel de votre service.</p>
<h3 id="deploiement-avec-docker-compose">Deploiement avec Docker Compose</h3>
<p>Créez un fichier <code>docker-compose.yml</code> dans le même répertoire avec le contenu suivant :</p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span>
<span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;3000:3000&quot;</span>
</code></pre></div>
<h3 id="mappage-de-port-entre-hote-et-container">Mappage de Port entre Hote et container</h3>
<p>Le mappage de port dans Docker Compose permet de lier les ports d'un conteneur à des ports spécifiques de l'hôte, permettant ainsi aux services exécutés dans les conteneurs d'être accessibles depuis l'extérieur du conteneur.</p>
<p>Dans le fichier <code>docker-compose.yml</code>, la section <code>ports</code> sous un service spécifie le mappage de port. Voici comment cela fonctionne :</p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-node-app</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;3000:3000&quot;</span>
</code></pre></div>
<p>Dans cet exemple :</p>
<ul>
<li><code>"3000:3000"</code> indique le mappage du port. Le premier numéro (3000 à gauche du <code>:</code>) représente le port sur l'hôte, tandis que le second numéro (3000 à droite du <code>:</code>) représente le port dans le conteneur.</li>
</ul>
<p>Ainsi, avec cette configuration, le port 3000 du conteneur sera accessible à partir du port 3000 de l'hôte. Si vous avez plusieurs services, chaque service peut avoir son propre mappage de port.</p>
<p>Dans ce cas, Docker attribuera un port disponible sur l'hôte, et vous pouvez découvrir ce port avec la commande <code>docker-compose ps</code>.</p>
<p>Le mappage de port est essentiel pour exposer les services d'un conteneur à l'extérieur et permettre aux utilisateurs d'accéder à ces services depuis l'hôte ou d'autres machines dans le réseau, selon la configuration du réseau Docker.</p>
<h3 id="mappage-des-volumes">Mappage des volumes</h3>
<p>Le mappage des volumes est une pratique essentielle dans Docker qui permet de persister les données générées par les conteneurs au-delà de leur cycle de vie. Lorsque vous exécutez un conteneur, ses données peuvent être stockées dans son système de fichiers interne. Cependant, une fois le conteneur arrêté ou supprimé, ces données peuvent être perdues. Le mappage de volumes résout ce problème en créant un lien entre un dossier sur l'hôte et un dossier à l'intérieur du conteneur.</p>
<p>Par exemple, pour créer un volume nommé "mydata" et le monter dans le répertoire "/app" d'un conteneur, vous pouvez utiliser l'option <code>-v</code> lors de la création du conteneur :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span>mydata:/app<span class="w"> </span>my-image
</code></pre></div>
<p>Cela assure la persistance des données du conteneur dans le volume "mydata" sur l'hôte, permettant ainsi de partager des données entre plusieurs conteneurs ou de sauvegarder ces données même si le conteneur est supprimé.</p>
<p>Le mappage des volumes est particulièrement utile pour les applications nécessitant le stockage de données, comme les bases de données, les serveurs de fichiers, et autres. Il offre une flexibilité et une gestion facile des données dans le contexte des conteneurs Docker.</p>
<p>Voici un exemple simple d'utilisation du mappage de volumes avec Docker Compose. Supposons que vous avez une application Node.js qui stocke des données dans un dossier <code>/app/data</code> et que vous souhaitez persister ces données en utilisant un volume.</p>
<p>Créez un fichier <code>docker-compose.yml</code> avec le contenu suivant :</p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">webapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-node-app</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;3000:3000&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mydata:/app/data</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mydata</span><span class="p">:</span>
</code></pre></div>
<p>Dans cet exemple :</p>
<ul>
<li>Le service <code>webapp</code> utilise l'image <code>my-node-app</code> (remplacez cela par l'image réelle de votre application Node.js).</li>
<li>Le mappage de port expose le port 3000 du conteneur vers le port 3000 de l'hôte.</li>
<li>La section <code>volumes</code> crée un volume nommé "mydata" et le monte dans le répertoire <code>/app/data</code> du conteneur.</li>
</ul>
<p>Lorsque vous lancez votre application avec <code>docker-compose up -d</code>, le volume "mydata" est créé, et les données générées par l'application dans le dossier <code>/app/data</code> du conteneur sont persistées sur l'hôte, dans le volume "mydata".</p>
<p>Cette approche garantit que les données de votre application restent disponibles même si le conteneur est arrêté ou supprimé. Vous pouvez également partager ce volume entre plusieurs services dans le même <code>docker-compose.yml</code> ou même entre plusieurs applications s'exécutant sur la même machine.</p>
<h3 id="lancement-des-containners">Lancement des containners</h3>
<p>Ouvrez un terminal dans le répertoire de votre application et exécutez la commande suivante pour construire et démarrer votre conteneur :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>up
</code></pre></div>
<p>Votre application Node.js sera accessible à l'adresse http://localhost:3000. Vous pouvez modifier le port dans le fichier <code>docker-compose.yml</code> si nécessaire.</p>
<p>N'oubliez pas d'arrêter les conteneurs avec la commande suivante lorsque vous avez terminé :</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>down
</code></pre></div>
<p>Ceci est un exemple simple pour démarrer. Vous pouvez étendre et personnaliser votre Dockerfile en fonction des besoins de votre application.</p>
<h2 id="commande-de-base-quand-on-travaille-avec-docker">Commande de base quand on travaille avec docker</h2>
<p>Voici quelques commandes de base indispensables à connaître pour travailler avec Docker :</p>
<ol>
<li>
<p><strong><code>docker --version</code></strong> : Affiche la version de Docker installée.</p>
</li>
<li>
<p><strong><code>docker pull &lt;image&gt;</code></strong> : Télécharge une image Docker depuis Docker Hub ou un autre registre. Par exemple, <code>docker pull nginx</code> télécharge l'image NGINX.</p>
</li>
<li>
<p><strong><code>docker images</code></strong> : Affiche la liste des images Docker téléchargées sur votre machine.</p>
</li>
<li>
<p><strong><code>docker ps</code></strong> : Affiche la liste des conteneurs Docker en cours d'exécution.</p>
</li>
<li>
<p><strong><code>docker ps -a</code></strong> : Affiche tous les conteneurs, qu'ils soient en cours d'exécution ou arrêtés.</p>
</li>
<li>
<p><strong><code>docker run &lt;options&gt; &lt;image&gt;</code></strong> : Crée et démarre un conteneur à partir d'une image. Par exemple, <code>docker run -d -p 8080:80 nginx</code> démarre un conteneur NGINX en arrière-plan, exposant le port 8080 de l'hôte vers le port 80 du conteneur.</p>
</li>
<li>
<p><strong><code>docker exec -it &lt;container&gt; &lt;command&gt;</code></strong> : Exécute une commande à l'intérieur d'un conteneur en cours d'exécution en mode interactif. Par exemple, <code>docker exec -it my-container /bin/bash</code> ouvre un shell Bash interactif à l'intérieur du conteneur.</p>
</li>
<li>
<p><strong><code>docker stop &lt;container&gt;</code></strong> : Arrête un conteneur en cours d'exécution. Vous pouvez également utiliser <code>docker kill</code> pour arrêter immédiatement le conteneur.</p>
</li>
<li>
<p><strong><code>docker rm &lt;container&gt;</code></strong> : Supprime un conteneur arrêté.</p>
</li>
<li>
<p><strong><code>docker rmi &lt;image&gt;</code></strong> : Supprime une image Docker de votre système.</p>
</li>
<li>
<p><strong><code>docker-compose up -d</code></strong> : Démarre les services définis dans le fichier <code>docker-compose.yml</code> en mode détaché.</p>
</li>
<li>
<p><strong><code>docker-compose down</code></strong> : Arrête les services définis dans le fichier <code>docker-compose.yml</code> et supprime les conteneurs associés.</p>
</li>
<li>
<p><strong><code>docker logs &lt;container&gt;</code></strong> : Affiche les journaux d'un conteneur spécifique.</p>
</li>
<li>
<p><strong><code>docker network ls</code></strong> : Affiche la liste des réseaux Docker.</p>
</li>
<li>
<p><strong><code>docker volume ls</code></strong> : Affiche la liste des volumes Docker.</p>
</li>
</ol>
<p>Ces commandes constituent une base solide pour travailler avec Docker. N'oubliez pas de consulter la documentation officielle de Docker pour des informations plus détaillées sur chaque commande : <a href="https://docs.docker.com/">Documentation Docker</a>.</p>
<p><img alt="" src="../../medias/cours/docker/docker-architecture.webp" /></p>
<h2 id="outil-dadministration">Outil d'administration</h2>
<p><strong>Portainer</strong> est une interface graphique open source pour la gestion des conteneurs Docker. Il fournit une interface utilisateur web intuitive pour visualiser, gérer et déployer des applications dans des conteneurs Docker. Voici quelques caractéristiques clés de Portainer :</p>
<p>Pour utiliser Portainer, vous pouvez le déployer en tant que conteneur Docker unique à l'aide de la commande suivante :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">9000</span>:9000<span class="w"> </span>--name<span class="o">=</span>portainer<span class="w"> </span>--restart<span class="o">=</span>always<span class="w"> </span>-v<span class="w"> </span>/var/run/docker.sock:/var/run/docker.sock<span class="w"> </span>portainer/portainer-ce
</code></pre></div>
<p>Cela lancera Portainer en mode détaché et le rendra accessible sur le port 9000 de votre machine. Vous pouvez ensuite accéder à l'interface web et commencer à gérer vos conteneurs.</p>
<p>En ce qui concerne d'autres outils similaires, voici quelques alternatives à Portainer :</p>
<ol>
<li>
<p><strong>Kitematic :</strong> Une interface graphique pour Docker compatible avec Windows, macOS et Linux.</p>
</li>
<li>
<p><strong>Rancher :</strong> Une plateforme de gestion de conteneurs open source qui prend en charge Kubernetes et Docker.</p>
</li>
<li>
<p><strong>Swarm UI :</strong> Une interface web native pour la gestion des clusters Docker Swarm.</p>
</li>
<li>
<p><strong>Cockpit :</strong> Une interface web pour la gestion des serveurs Linux qui prend en charge Docker.</p>
</li>
<li>
<p><strong>Shipyard :</strong> Une interface web open source pour la gestion de Docker.</p>
</li>
</ol>
<p>Ces outils offrent des fonctionnalités similaires, mais la meilleure option dépend souvent des besoins spécifiques de votre environnement et de votre préférence en matière d'interface utilisateur.</p>
<h2 id="clusterisation-des-noeuds-docker">Clusterisation des noeuds Docker</h2>
<p><strong>Docker Swarm</strong> est un outil de gestion de cluster Docker intégré qui permet de créer et de gérer un ensemble de nœuds Docker, transformant ainsi plusieurs machines en un seul pool de ressources.
Outre Docker Swarm, d'autres solutions de gestion de clusters Docker incluent <strong>Kubernetes</strong>, <strong>Apache Mesos</strong>, et <strong>Amazon ECS</strong>. Chacune de ces solutions a ses propres caractéristiques et avantages, et le choix dépend souvent des besoins spécifiques de votre environnement. Par exemple, Kubernetes est largement utilisé pour les déploiements à grande échelle, tandis que Docker Swarm offre une configuration plus simple pour les cas d'utilisation plus modestes.</p>
<h1 id="securite-des-conteneurs-docker">Sécurité des Conteneurs Docker</h1>
<p>La sécurité des conteneurs Docker est une préoccupation essentielle pour garantir la protection des applications et des données qu'ils contiennent. Voici un aperçu des bonnes pratiques de sécurité associées aux conteneurs Docker :</p>
<h2 id="1-utiliser-des-images-officielles-et-verifiees">1. <strong>Utiliser des Images Officielles et Vérifiées</strong></h2>
<p>Privilégiez l'utilisation d'images officielles provenant de dépôts de confiance tels que Docker Hub. Assurez-vous que les images utilisées sont régulièrement mises à jour et bénéficient du support de la communauté.</p>
<h2 id="2-mise-a-jour-reguliere-des-images-et-des-conteneurs">2. <strong>Mise à Jour Régulière des Images et des Conteneurs</strong></h2>
<p>Les mises à jour fréquentes des images et des conteneurs sont cruciales pour corriger les vulnérabilités de sécurité. Automatisez ce processus autant que possible pour maintenir votre environnement à jour.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>&lt;image&gt;:&lt;tag&gt;
docker-compose<span class="w"> </span>pull
</code></pre></div>
<h2 id="3-utilisation-de-non-root-users">3. <strong>Utilisation de Non-root Users</strong></h2>
<p>Évitez d'utiliser l'utilisateur root dans les conteneurs. Définissez un utilisateur non-root pour minimiser les risques potentiels.</p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span><span class="w"> </span><span class="s">base-image</span>
<span class="k">USER</span><span class="w"> </span><span class="s">nonrootuser</span>
</code></pre></div>
<h2 id="4-configuration-fine-des-ressources">4. <strong>Configuration Fine des Ressources</strong></h2>
<p>Limitez les ressources disponibles aux conteneurs avec <code>--memory</code>, <code>--cpu</code>, et d'autres options pour prévenir les attaques par déni de service.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>--memory<span class="o">=</span>512m<span class="w"> </span>--cpu<span class="o">=</span><span class="m">0</span>.5<span class="w"> </span>my-image
</code></pre></div>
<h2 id="5-isolation-des-reseaux">5. <strong>Isolation des Réseaux</strong></h2>
<p>Utilisez des réseaux Docker isolés pour empêcher les communications non autorisées entre conteneurs.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>--driver<span class="w"> </span>bridge<span class="w"> </span>my-network
docker<span class="w"> </span>run<span class="w"> </span>--network<span class="o">=</span>my-network<span class="w"> </span>my-container
</code></pre></div>
<p>En suivant ces meilleures pratiques de sécurité, vous pouvez renforcer la résilience de vos conteneurs Docker et atténuer les risques potentiels. Il est important de rester informé sur les mises à jour de sécurité et d'appliquer régulièrement les correctifs nécessaires pour garantir un environnement Docker sûr et fiable.</p>
<h1 id="exemple-de-stack-lamp-avec-plusieurs-containers-un-peu-obsolete-aujourdhui-car-repose-sur-une-debian-8">Exemple de stack LAMP avec plusieurs containers (un peu obsolete aujourd'hui car repose sur une Debian 8)</h1>
<p><img alt="" src="../../medias/cours/docker/arborescence.PNG" /></p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">m_apache</span><span class="p">:</span>
<span class="w">        </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/apache</span>
<span class="w">        </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_apache</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80:80</span>
<span class="w">        </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./docker/config/vhosts:/etc/apache2/sites-enabled</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">        </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_php</span>

<span class="w">    </span><span class="nt">m_mysql</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;--default-authentication-plugin=mysql_native_password&quot;</span>
<span class="w">        </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_mysql</span>
<span class="w">        </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./db:/var/lib/mysql</span>
<span class="w">        </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">            </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span>
<span class="w">            </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mery</span>
<span class="w">            </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mery</span>
<span class="w">            </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mery</span>

<span class="w">    </span><span class="nt">m_php</span><span class="p">:</span>
<span class="w">        </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/php</span>
<span class="w">        </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_php</span>
<span class="w">        </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">        </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_mysql</span>

<span class="w">    </span><span class="nt">m_phpmyadmin</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">phpmyadmin/phpmyadmin</span>
<span class="w">        </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_phpmyadmin</span>
<span class="w">        </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">          </span><span class="nt">PMA_HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_mysql</span>
<span class="w">          </span><span class="nt">PMA_PORT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3306</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080:80</span>
<span class="w">        </span><span class="nt">links</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m_mysql</span>
</code></pre></div>
<h3 id="fichier-dockerphpdockerfile">fichier docker/php/Dockerfile</h3>
<div class="highlight"><pre><span></span><code>FROM<span class="w"> </span>php:7.2.10-fpm

RUN<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--no-install-recommends<span class="w"> </span>vim<span class="w"> </span>curl<span class="w"> </span>debconf<span class="w"> </span>subversion<span class="w"> </span>git<span class="w"> </span>apt-transport-https<span class="w"> </span>apt-utils<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>build-essential<span class="w"> </span>locales<span class="w"> </span>acl<span class="w"> </span>mailutils<span class="w"> </span>wget<span class="w"> </span>nodejs<span class="w"> </span>zip<span class="w"> </span>unzip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gnupg<span class="w"> </span>gnupg1<span class="w"> </span>gnupg2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>zlib1g-dev<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>sudo

RUN<span class="w"> </span>docker-php-ext-install<span class="w"> </span>pdo<span class="w"> </span>pdo_mysql<span class="w"> </span>zip

COPY<span class="w"> </span>php.ini<span class="w"> </span>/usr/local/etc/php/php.ini
COPY<span class="w"> </span>php-fpm-pool.conf<span class="w">  </span>/usr/local/etc/php/pool.d/www.conf

RUN<span class="w"> </span>curl<span class="w"> </span>-sSk<span class="w"> </span>https://getcomposer.org/installer<span class="w"> </span><span class="p">|</span><span class="w"> </span>php<span class="w"> </span>--<span class="w"> </span>--disable-tls<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>mv<span class="w"> </span>composer.phar<span class="w"> </span>/usr/local/bin/composer

RUN<span class="w"> </span>wget<span class="w"> </span>--no-check-certificate<span class="w"> </span>https://phar.phpunit.de/phpunit-6.5.3.phar<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>mv<span class="w"> </span>phpunit*.phar<span class="w"> </span>phpunit.phar<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>chmod<span class="w"> </span>+x<span class="w"> </span>phpunit.phar<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>mv<span class="w"> </span>phpunit.phar<span class="w"> </span>/usr/local/bin/phpunit

RUN<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb https://deb.nodesource.com/node_6.x jessie main&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/apt/sources.list.d/nodejs.list<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wget<span class="w"> </span>-nv<span class="w"> </span>-O<span class="w"> </span>-<span class="w">  </span>https://deb.nodesource.com/gpgkey/nodesource.gpg.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb-src https://deb.nodesource.com/node_6.x jessie main&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/apt/sources.list.d/nodejs.list<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--force-yes<span class="w"> </span>nodejs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>rm<span class="w"> </span>-f<span class="w"> </span>/etc/apt/sources.list.d/nodejs.list

RUN<span class="w"> </span>groupadd<span class="w"> </span>dev<span class="w"> </span>-g<span class="w"> </span><span class="m">999</span>
RUN<span class="w"> </span>useradd<span class="w"> </span>dev<span class="w"> </span>-g<span class="w"> </span>dev<span class="w"> </span>-d<span class="w"> </span>/home/dev<span class="w"> </span>-m
RUN<span class="w"> </span>passwd<span class="w"> </span>-d<span class="w"> </span>dev

RUN<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*
RUN<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;en_US.UTF-8 UTF-8&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/locale.gen<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;fr_FR.UTF-8 UTF-8&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/locale.gen<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>locale-gen

RUN<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;dev ALL=(ALL) ALL&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/sudoers

WORKDIR<span class="w"> </span>/var/www/
<span class="c1">##&lt;/romaricp&gt;##</span>

EXPOSE<span class="w"> </span><span class="m">9000</span>
CMD<span class="w"> </span><span class="o">[</span><span class="s2">&quot;php-fpm&quot;</span><span class="o">]</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>